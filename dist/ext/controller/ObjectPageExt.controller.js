sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox","sap/m/Text"],function(e,t,a){"use strict";return{onInit:function(e){},onBeforeRendering:function(e){},scanHU:function(e){var a="000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().outboundDelivery;var s=e.getSource().getParent().getParent().getBindingContext().getObject().shipTo;var i="0000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDeliveryItem;var r=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().packInst;var o="000000000000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().material;var n=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().uom;o=o.substr(o.length-18);i=i.substr(i.length-6);a=a.substr(a.length-10);var l=0;var u;var p=this.extensionAPI;var c=new sap.m.Button("Cancel",{text:"Cancel"});var g=new sap.m.Button("OK",{text:"OK"});var d=new sap.m.Dialog("Dialog1",{title:"Enter HU",contentWidth:"20%",closeOnNavigation:true,buttons:[g,c],content:[new sap.m.Label({text:"HU:",required:true}),new sap.m.Input({maxLength:20,id:"HUBarcode",type:"Text"})]});sap.ui.getCore().byId("HUBarcode").onsapenter=function(l){if(sap.ui.getCore().byId("HUBarcode").getValue().substr(0,4)=="(00)"){var c=sap.ui.getCore().byId("HUBarcode").getValue().substr(4,sap.ui.getCore().byId("HUBarcode").getValue().length-1);var g="00000000000"+c;u=g.substr(g.length-20)}else{var g="00000000000"+sap.ui.getCore().byId("HUBarcode").getValue();u=g.substr(g.length-20)}var m=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");m.callFunction("/validateHU",{method:"POST",urlParameters:{HandlingUnit:u,PackInstructions:r,Customer:s,Delivery:a,DeliveryItem:i,DeliveryUOM:n},success:function(s,r){if(s.Type=="W"){t.warning(s.Message,{actions:["OK",t.Action.CLOSE],emphasizedAction:"OK",onClose:function(t){if(t=="OK"){onContinueAddHU(e,u,i,o,n,a,p)}}})}else if(s.Type=="E"){sap.m.MessageBox.error(s.Message)}else{onContinueAddHU(e,u,i,o,n,a,p)}d.close();d.destroy();d=null},error:function(e){sap.m.MessageBox.error(e.response.body);d.close();d.destroy();d=null}})};c.attachPress(function(e){d.close();d.destroy();d=null});g.attachPress(function(l){if(sap.ui.getCore().byId("HUBarcode").getValue().substr(0,4)=="(00)"){var c=sap.ui.getCore().byId("HUBarcode").getValue().substr(4,sap.ui.getCore().byId("HUBarcode").getValue().length-1);var g="00000000000"+c;u=g.substr(g.length-20)}else{var g="00000000000"+sap.ui.getCore().byId("HUBarcode").getValue();u=g.substr(g.length-20)}var m=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");m.callFunction("/validateHU",{method:"POST",urlParameters:{HandlingUnit:u,PackInstructions:r,Customer:s,Delivery:a,DeliveryItem:i,DeliveryUOM:n},success:function(s,r){if(s.Type=="W"){t.warning(s.Message,{actions:["OK",t.Action.CLOSE],emphasizedAction:"OK",onClose:function(t){if(t=="OK"){onContinueAddHU(e,u,i,o,n,a,p)}}})}else if(s.Type=="E"){sap.m.MessageBox.error(s.Message)}else{onContinueAddHU(e,u,i,o,n,a,p)}d.close();d.destroy();d=null},error:function(e){console.log(e);sap.m.MessageBox.error(e.response.body);d.close();d.destroy();d=null}})});d.addStyleClass("sapUiContentPadding");d.open()},updateSeal:function(e){var t=e.getSource().getParent().getParent().getBindingContext().getObject();var a=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().HUNum;var s="00000000000"+a;var i=s.substr(s.length-20);var r=this.extensionAPI;var o=new sap.m.Button("Cancel",{text:"Cancel"});var n=new sap.m.Button("OK",{text:"OK"});n.attachPress(function(e){var t=sap.ui.getCore().byId("Seal").getValue();var a=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");a.callFunction("/updateSealNumber",{method:"POST",urlParameters:{HUNumber:i,sealNumber:t},success:function(e,t){console.log(e);var a=e.Message;var s=e.Type;if(s=="S"){console.log(a);sap.m.MessageToast.show(a)}else{sap.m.MessageBox.error(a)}l.close();l.destroy();l=null},error:function(e){console.log(e);sap.m.MessageBox.error(e);l.close();l.destroy();l=null}})});o.attachPress(function(e){l.close();l.destroy();l=null});var l=new sap.m.Dialog("Dialog1",{title:"Update Seal Number",contentWidth:"20%",closeOnNavigation:true,buttons:[n,o],content:[new sap.m.Label({text:"Seal:"}),new sap.m.Input({maxLength:20,id:"Seal"})]});l.addStyleClass("sapUiContentPadding");l.open()},addBatch:function(e){var t=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().material;var a="0000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDeliveryItem;var s="000000000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDelivery;var i=e.getSource().getParent().getParent().getBindingContext().getObject().plant;s=s.substr(s.length-10);a=a.substr(a.length-6);var r=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().uom;var o=0;var n=0;var l=0;var u=this.extensionAPI;var p=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().storageLocation;var c=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var g=new Array;var d=new sap.ui.model.Filter({path:"outboundDelivery",operator:sap.ui.model.FilterOperator.EQ,value1:s});g.push(d);d=new sap.ui.model.Filter({path:"outboundDeliveryItem",operator:sap.ui.model.FilterOperator.EQ,value1:a});g.push(d);c.read("/ZSCM_BulkProd_L1",{filters:g,success:function(e,t){console.log(e.results.length);for(let t=0;t<e.results.length;t++){n+=parseFloat(e.results[t].plannedQuant,10);if(parseInt(mResult.text,10)==parseInt(e.results[t].plannedQuant,10)){l=1}}}});var m=new sap.m.Button("Cancel",{text:"Cancel"});var v=new sap.m.Button("OK",{text:"OK"});v.attachPress(function(e){var o=new sap.m.BusyDialog;o.open();var l=sap.ui.getCore().byId("Batch").getValue();var c=sap.ui.getCore().byId("Qty").getValue();if(l==""){sap.m.MessageToast.show("Please Enter Batch");o.close()}else if(c==""||c<=0){sap.m.MessageToast.show("Please Enter Qty");o.close()}else if(Number.isInteger(parseFloat(c,2))==false){sap.m.MessageToast.show("Cannot pick a decimal");o.close()}else{var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var d=new Array;var m=new sap.ui.model.Filter({path:"Matnr",operator:sap.ui.model.FilterOperator.EQ,value1:t});d.push(m);m=new sap.ui.model.Filter({path:"Werks",operator:sap.ui.model.FilterOperator.EQ,value1:i});d.push(m);m=new sap.ui.model.Filter({path:"Charg",operator:sap.ui.model.FilterOperator.EQ,value1:l});d.push(m);m=new sap.ui.model.Filter({path:"lgort",operator:sap.ui.model.FilterOperator.EQ,value1:p});d.push(m);g.read("/ZSCM_I_ValidBatch",{filters:d,success:function(e,t){if(e.results.length>0){console.log(e.results[0].lgort);if(e.results[0].lgort!=p){sap.m.MessageBox.error("Batch does not have stock in the picking storage location.");b.close();b.destroy();b=null;o.close()}else{var i=n+parseFloat(c);var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");g.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:a,deliveryNumber:s,uom:r,pickAmount:c,qty:c,bakeryFlag:false},success:function(e,t){console.log(e);if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch "+l+" added to delivery "+s,{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});u.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_C_PICKINGAPP--ScenarioNoHU::Table");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_PickList_S2_L1--BulkProd::Table")!=undefined){sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_PickList_S2_L1--BulkProd::Table").getModel().refresh(true)}}b.close();b.destroy();b=null;o.close()},error:function(e){o.close();console.log(e);sap.m.MessageBox.error(e);b.close();b.destroy();b=null}})}}else{var d="Invalid Batch.";o.close();sap.m.MessageBox.error(d);b.close();b.destroy();b=null}},error:function(e){o.close();console.log(e)}})}});m.attachPress(function(e){b.close();b.destroy();b=null});var b=new sap.m.Dialog("Dialog1",{title:"Add Batch",contentWidth:"20%",closeOnNavigation:true,draggable:true,buttons:[v,m],content:[new sap.m.Label({text:"Batch:",required:true}),new sap.m.Input({maxLength:20,id:"Batch",type:"Text",liveChange:function(e){var t=e.getSource();t.setValue(t.getValue().toUpperCase())}}),new sap.m.Label({text:"Qty:",required:true}),new sap.m.Input({maxLength:20,id:"Qty",type:"Number"})]});b.addStyleClass("sapUiContentPadding");b.open()},removeBatch:function(e){var t="000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().outboundDelivery;var a=t.substr(t.length-10);var s=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDeliveryItem;var i=parseFloat(e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().plannedQuant);var r=0;var o=0;var n=this.extensionAPI;var l=new sap.m.BusyDialog;l.open();var u=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");u.callFunction("/removeBatchFromDelivery",{method:"POST",urlParameters:{deliveryNumber:a,batchItem:s},success:function(e,t){l.close();if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch removed",{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true})}n.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_PickList_S2_L1--BulkProd::Table");n.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_C_PICKINGAPP--ScenarioNoHU::Table")},error:function(e){var t="Unable to remove Batch.";sap.m.MessageToast.show(t);l.close()}})},addBatchBakery:function(e){var a="00000000000000000000"+e.getSource().getParent().getParent().getBindingContext().getObject().transportOrder;a=a.substr(a.length-20);var s="000000000000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().material;s=s.substr(s.length-18);var i=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().quant;var r=e.getSource().getParent().getParent().getBindingContext().getObject().plant;var o="0000000000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDelivery;o=o.substr(o.length-10);var n=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().mixtype;var l;var u;var p=this.extensionAPI;var c=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().storLoc;var g=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().TotalQuant;var d=new sap.m.BusyDialog;d.open();if(sap.ui.getCore().byId("OK")===undefined){var m=new sap.m.Button("OK",{text:"OK"})}else if(sap.ui.getCore().byId("OK")!=undefined){var m=sap.ui.getCore().byId("OK")}if(sap.ui.getCore().byId("Continue")===undefined){var v=new sap.m.Button("Continue",{text:"Continue"})}else if(sap.ui.getCore().byId("Continue")!=undefined){var v=sap.ui.getCore().byId("Continue")}if(sap.ui.getCore().byId("Cancel")===undefined){var b=new sap.m.Button("Cancel",{text:"Cancel"})}else if(sap.ui.getCore().byId("Cancel")!=undefined){var b=sap.ui.getCore().byId("Cancel")}if(sap.ui.getCore().byId("Cancel2")===undefined){var C=new sap.m.Button("Cancel2",{text:"Cancel"})}else if(sap.ui.getCore().byId("Cancel2")!=undefined){var C=sap.ui.getCore().byId("Cancel2")}if(sap.ui.getCore().byId("Cancel3")===undefined){var y=new sap.m.Button("Cancel3",{text:"Cancel"})}else if(sap.ui.getCore().byId("Cancel3")!=undefined){var y=sap.ui.getCore().byId("Cancel3")}b.attachPress(function(e){d.close();if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}if(sap.ui.getCore().byId("Dialog2")!=undefined){sap.ui.getCore().byId("Dialog2").close();sap.ui.getCore().byId("Dialog2").destroy()}});m.attachPress(function(e){u=sap.ui.getCore().byId("Qty").getValue();l=sap.ui.getCore().byId("Batch").getValue();var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var m=new Array;var v=new sap.ui.model.Filter({path:"Matnr",operator:sap.ui.model.FilterOperator.EQ,value1:s});m.push(v);v=new sap.ui.model.Filter({path:"Werks",operator:sap.ui.model.FilterOperator.EQ,value1:r});m.push(v);v=new sap.ui.model.Filter({path:"Charg",operator:sap.ui.model.FilterOperator.EQ,value1:l});m.push(v);g.read("/ZSCM_I_ValidBatch",{filters:m,success:function(e,r){if(e.results.length>0){if(u==""||u<=0){sap.m.MessageToast.show("Please Enter Qty")}else if(Number.isInteger(parseFloat(u,2))==false){sap.m.MessageToast.show("Cannot pick a decimal")}else if(e.results[0].lgort!=c){if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}if(sap.ui.getCore().byId("Dialog2")!=undefined){sap.ui.getCore().byId("Dialog2").close();sap.ui.getCore().byId("Dialog2").destroy()}if(sap.ui.getCore().byId("Dialog2")==undefined){sap.m.MessageBox.error("Batch does not have stock in the picking storage location.")}}else{if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}if(sap.ui.getCore().byId("Dialog2")!=undefined){sap.ui.getCore().byId("Dialog2").close();sap.ui.getCore().byId("Dialog2").destroy()}if(parseInt(u,10)<parseInt(i,10)&&n=="Mixed"){console.log("here rebind");t.warning("You have short picked the material. If you plan to split batch continue otherwise cancel and amend delivery.",{actions:["Continue",t.Action.CLOSE],emphasizedAction:"Continue",onClose:function(e){if(e=="Continue"){var t="";var i=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var r=new Array;var n=new sap.ui.model.Filter({path:"transportOrder",operator:sap.ui.model.FilterOperator.EQ,value1:a});r.push(n);n=new sap.ui.model.Filter({path:"material",operator:sap.ui.model.FilterOperator.EQ,value1:s});r.push(n);i.read("/ZSCM_I_Bakery_PickList_L2",{filters:r,success:function(e,t){var a=u;for(let t=0;t<e.results.length;t++){if(o==e.results[t].outboundDelivery){var s="000000000"+e.results[t].outboundDelivery;s=s.substr(s.length-10);var i="0000"+e.results[t].item;i=i.substr(i.length-6);var r=e.results[t].uom;var n=parseInt(e.results[t].quant);var c=parseInt(e.results[t].quant);var g=n;var m=0;var v=0;var b=parseInt(a,10);if(g<b){v=g}else{v=b}a=parseInt(a,10)-n;if(a<=0){var m=v;var C=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");C.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:i,deliveryNumber:s,uom:r,pickAmount:m,qty:m,bakeryFlag:true},success:function(e,t){if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch "+l+" added to delivery "+s,{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")!=undefined){sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table").getModel().refresh(true)}p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table");p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")}},error:function(){var e="Unable to assign Batch.";sap.m.MessageToast.show(e)}});break}else{var m=c+n;var C=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");C.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:i,deliveryNumber:s,uom:r,pickAmount:m,qty:m,bakeryFlag:true},success:function(e,t){if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch "+l+" added to delivery "+s,{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table");p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")!=undefined){console.log("14");sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table").getModel().refresh(true)}}},error:function(){var e="Unable to assign Batch.";sap.m.MessageToast.show(e)}})}}}d.close()},error:function(e){console.log(e);sap.m.MessageBox.error(e);d.close()}});if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy();d.close()}if(sap.ui.getCore().byId("Dialog2")!=undefined){sap.ui.getCore().byId("Dialog2").close();sap.ui.getCore().byId("Dialog2").destroy();d.close()}}}})}else if(parseInt(u,10)>parseInt(i,10)&&n=="Mixed"){sap.m.MessageBox.error("Overpicked than the requested quantity in delivery.")}else if(parseInt(u,10)>parseInt(i,10)&&n!="Mixed"){console.log("here1");var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var m=new Array;var v=new sap.ui.model.Filter({path:"transportOrder",operator:sap.ui.model.FilterOperator.EQ,value1:a});m.push(v);v=new sap.ui.model.Filter({path:"material",operator:sap.ui.model.FilterOperator.EQ,value1:s});m.push(v);v=new sap.ui.model.Filter({path:"mixtype",operator:sap.ui.model.FilterOperator.EQ,value1:"Unmixed"});m.push(v);g.read("/ZSCM_I_Bakery_PickList_L2",{filters:m,success:function(e,t){console.log(e);var i=0;for(let t=0;t<e.results.length;t++){i+=parseInt(e.results[t].quant,10)}if(parseInt(u,10)<=i){var r=new Array;var n=new sap.ui.model.Filter({path:"transportOrder",operator:sap.ui.model.FilterOperator.EQ,value1:a});r.push(n);n=new sap.ui.model.Filter({path:"material",operator:sap.ui.model.FilterOperator.EQ,value1:s});r.push(n);g.read("/ZSCM_I_Bakery_PickList_L2",{filters:r,success:function(e,t){var a=parseInt(u,10);for(let u=0;u<e.results.length;u++){if(o==e.results[u].outboundDelivery){var s="000000000"+e.results[u].outboundDelivery;s=s.substr(s.length-10);var i="0000"+e.results[u].item;i=i.substr(i.length-6);var r=e.results[u].uom;var n=parseInt(e.results[u].quant,10);a=a-n;console.log(e);console.log(t.headers.etag);var c=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");c.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:i,deliveryNumber:s,uom:r,pickAmount:n,qty:n,bakeryFlag:true},success:function(e,t){if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch "+l+" added to delivery "+s,{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table");console.log("10");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")!=undefined){console.log("11");sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table").getModel().refresh(true)}p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")}}.bind(this),error:function(){var e="Unable to assign Batch.";sap.m.MessageToast.show(e)}})}}if(a>0){for(let t=0;t<e.results.length;t++){if(a>0){if(o!=e.results[t].outboundDelivery){var g="000000000"+e.results[t].outboundDelivery;g=g.substr(g.length-10);var d="0000"+e.results[t].item;d=d.substr(d.length-6);var m=e.results[t].uom;var v=parseInt(e.results[t].quant,10);if(v>a){v=a;a=0}else if(v==a){a=0}else if(v<a){a=a-v}else if(v==0){break}var b=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");b.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:d,deliveryNumber:g,uom:m,pickAmount:v,qty:v,bakeryFlag:true}})}}}}}.bind(this),error:function(e){console.log(e)}})}else{sap.m.MessageBox.error("Overpicked than the requested quantity in delivery.")}}})}else{var g=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGAPP_SRV");var m=new Array;var v=new sap.ui.model.Filter({path:"transportOrder",operator:sap.ui.model.FilterOperator.EQ,value1:a});m.push(v);v=new sap.ui.model.Filter({path:"material",operator:sap.ui.model.FilterOperator.EQ,value1:s});m.push(v);console.log("here3");g.read("/ZSCM_I_Bakery_PickList_L2",{filters:m,success:function(e,t){for(let t=0;t<e.results.length;t++){console.log(e.results[t].outboundDelivery);console.log(o);if(o==e.results[t].outboundDelivery){var a="000000000"+e.results[t].outboundDelivery;a=a.substr(a.length-10);var s="0000"+e.results[t].item;s=s.substr(s.length-6);var i=e.results[t].uom;var r=parseInt(e.results[t].quant,10);if(parseInt(u,10)<parseInt(r,10)){r=u}var n=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");n.callFunction("/addBatchToDelivery",{method:"POST",urlParameters:{batch:l,deliveryItem:s,deliveryNumber:a,uom:i,pickAmount:r,qty:r,bakeryFlag:true},success:function(e,t){if(e.Type=="E"){sap.m.MessageBox.error(e.Message)}else{sap.m.MessageToast.show("Batch "+l+" added to delivery "+a,{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});p.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table");p.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")!=undefined){console.log("12");sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table").getModel().refresh(true)}}}.bind(this),error:function(e){var t="Unable to assign Batch.";sap.m.MessageToast.show(t);console.log(e)}})}}},error:function(e){console.log(e)}})}p.rebind("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table")!=undefined){sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table").getModel().refresh(true)}}}else{var b="Invalid Batch.";sap.m.MessageBox.error(b);if(sap.ui.getCore().byId("Dialog1")!=undefined){sap.ui.getCore().byId("Dialog1").close();sap.ui.getCore().byId("Dialog1").destroy()}}d.close()}.bind(this),error:function(e){console.log(e);d.close()}})});var h=new sap.m.Dialog("Dialog1",{title:"Scan Batch and Enter Quantity",contentWidth:"20%",closeOnNavigation:true,buttons:[m,b],content:[new sap.m.Label({text:"Batch:",required:true}),new sap.m.Input({maxLength:20,id:"Batch",liveChange:function(e){var t=e.getSource();t.setValue(t.getValue().toUpperCase())}}),new sap.m.Label({text:"Qty:",required:true}),new sap.m.Input({maxLength:20,id:"Qty",type:"Number"})]});h.addStyleClass("sapUiContentPadding");h.open()},removeBatchBakery:function(e){var t="000000000"+e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().outboundDelivery;console.log(e.getSource().getParent().getParent().getBindingContext().getObject().outboundDelivery);var a=t.substr(t.length-10);var s=e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().item;var i=parseFloat(e.getSource().getParent().getParent().getSelectedContexts()[0].getObject().plannedQuant);var r=0;var o=0;var n=this.extensionAPI;var l=new sap.m.BusyDialog;l.open();var u=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");u.callFunction("/removeBatchFromDelivery",{method:"POST",urlParameters:{deliveryNumber:a,batchItem:s},success:function(e,t){if(e.Type=="E"){sap.m.MessageBox.error(e.Message);l.close()}else{sap.m.MessageToast.show("Batch removed",{duration:3e3,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:true});l.close();n.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_PickList_L2--PickList::Table");if(sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table")!=undefined){sap.ui.getCore().byId("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table").getModel().refresh(true)}n.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_I_Bakery_L2--PickList::Table")}}.bind(this),error:function(e){l.close();var t="Unable to remove Batch.";sap.m.MessageToast.show(t)}})}}});function onContinueAddHU(e,t,a,s,i,r,o){var n=new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/ZSCM_PICKINGACTION_SRV");n.callFunction("/assignHUToDelivery",{method:"POST",urlParameters:{deliveryNumber:r,deliveryItem:a,HU_EXID:t,material:s,picked:"0",batch:"",uom:i},success:function(e,t){console.log(e);var a=e.Message;var s=e.Type;if(s=="S"){console.log(a);sap.m.MessageToast.show(a);o.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_C_PICKINGAPP--ScenarioHU::Table");o.refresh("pickingapp.pickingapp::sap.suite.ui.generic.template.ObjectPage.view.Details::ZSCM_PickList_S1_L2--Pallet::Table")}else{sap.m.MessageBox.error(a)}},error:function(e){console.log(e.response.body);sap.m.MessageBox.error(e.response.body)}})}
//# sourceMappingURL=ObjectPageExt.controller.js.map